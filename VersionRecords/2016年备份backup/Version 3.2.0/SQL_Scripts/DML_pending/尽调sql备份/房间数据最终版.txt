SELECT 
  flat_room.id '房间id',
  flat_flats.`landlordId` '房东id',
  flat_room.`flatsId` '房屋id',
  flat_room.`roomName` '房间名称',
  flat_room.`area` '房间面积',
  CASE
    flat_room.`rentStatus` 
    WHEN 1 
    THEN '未租' 
    WHEN 2 
    THEN '已租' 
    WHEN 3 
    THEN '预定' 
    WHEN 4 
    THEN '未上线' 
  END '出租状态',
  CASE
    flat_room.`status` 
    WHEN 1 
    THEN '是' 
    WHEN 0 
    THEN '无效' 
  END '是否有效',
  flat_room.`createTime` '创建时间',
  CASE
    WHEN (
      ISNULL(mogoOfflineEndTime) 
      OR mogoOfflineEndTime < NOW()
    ) 
    AND onlineStatus != 2 
    AND verifyStatus != 3 
    AND flat_room.`rentStatus` = 1 
    AND flat_room.`status` = 1 
    THEN '上架' 
    WHEN (
      (
        mogoOfflineEndTime IS NOT NULL 
        AND mogoOfflineEndTime >= NOW()
      ) 
      OR flat_room.`rentStatus` IN (2, 3) 
      OR onlineStatus = 2 
      OR flat_room.`status` = 0 
      OR verifyStatus = 3
    ) 
    THEN '下架' 
  END '上下架状态',
  flat_room.`showPrice` '官网显示价格（取最小）',
  CASE
    flat_flats.`rentType` 
    WHEN 1 
    THEN '单身公寓' 
    WHEN 2 
    THEN '合租' 
    WHEN 3 
    THEN '整租' 
  END '出租类型',
  CASE
    flat_flats.flatsTag 
    WHEN 1 
    THEN '分散式' 
    WHEN 2 
    THEN '集中式' 
  END '房源类型',
  user_info.`real_name` '房屋管家',
  CASE
    WHEN user_special.id IS NOT NULL 
    THEN '是' 
  END '是否是测试数据' 
FROM
  flat_room 
  LEFT JOIN flat_flats 
    ON flat_flats.id = flat_room.flatsid 
  LEFT JOIN flat_room_user_relation 
    ON flat_room_user_relation.`roomId` = flat_room.`id` 
    AND flat_room_user_relation.`userType` = 'userType-1' 
  LEFT JOIN user_info 
    ON user_info.id = flat_room_user_relation.`userId` 
    AND user_info.status = 1 
    AND user_info.phoneExt != 0 
  LEFT JOIN user_special 
    ON user_special.userid = flat_flats.`landlordId` 
    AND user_special.`userType` = 0 