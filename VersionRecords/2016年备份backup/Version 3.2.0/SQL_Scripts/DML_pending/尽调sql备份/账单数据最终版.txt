SELECT 
  bill_salebill.`id` '账单id',
  bill_salebill.`signedOrderId` '签约单id',
  oder_signedorder.`renterId` '租客id',
  oder_signedorder.`landlordId` '房东id',
  flat_flats.`flatsNum` '房源编号',
  bill_salebill.`amount` '账单金额',
  CASE
    WHEN bill_salebill.`bill_type` IN (1003, 1004) 
    THEN '租金' 
    ELSE '其他' 
  END '账单类型',
  DATE_FORMAT(
    bill_salebill.`dueDate`,
    '%Y-%m-%d'
  ) '应付款日（最后付款截止时间）',
  bill_salebill.`payTime` '实际付款日',
  CASE
    WHEN ISNULL(bill_salebill.`exempt`) 
    THEN '线上' 
    WHEN bill_salebill.`exempt` IS NOT NULL 
    THEN '线下' 
  END '线上/线下',
  CASE
    bill_salebill.`valid` 
    WHEN 1 
    THEN '是' 
    WHEN 0 
    THEN '无效' 
  END '是否有效',
  bill_salebill.`startDate` '账单开始时间',
  bill_salebill.`endDate` '账单结束时间',
  CASE
    WHEN user_special.id IS NOT NULL 
    OR usrenter.id IS NOT NULL 
    THEN '是' 
  END '是否是测试数据' 
FROM
  bill_salebill 
  LEFT JOIN oder_signedorder 
    ON oder_signedorder.id = bill_salebill.`signedOrderId` 
  LEFT JOIN flat_flats 
    ON flat_flats.`id` = oder_signedorder.`flatsId` 
  LEFT JOIN user_special 
    ON user_special.userid = oder_signedorder.`landlordId` 
    AND user_special.`userType` = 0 
  LEFT JOIN user_special usrenter 
    ON usrenter.userid = oder_signedorder.`renterId` 
    AND usrenter.usertype = 4 
WHERE bill_salebill.`payStatus` = 1 