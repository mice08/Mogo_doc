SELECT 
  DATE_FORMAT(
    loan_renter_repay.`paydate`,
    '%Y-%m-%d'
  ),
  loan_renter_repayplan.`duedate`,
  loan_renter_repay.`period`,
  loan_renter_contract.`contractno` 
FROM
  loan_renter_repayplan 
  JOIN loan_renter_contract 
    ON loan_renter_contract.`contractno` = loan_renter_repayplan.contractno 
  JOIN loan_renter_repay 
    ON loan_renter_repay.`contractno` = loan_renter_contract.`contractno` 
    AND loan_renter_repay.`period` = loan_renter_repayplan.eachnum 
  JOIN loan_renter_info 
    ON loan_renter_info.`id` = loan_renter_contract.`infoId` 
  JOIN oder_signedorder 
    ON oder_signedorder.id = loan_renter_info.`signedOrderId` 
WHERE valid = 1 
  AND duedate < '2016-07-01' 
  AND loan_renter_contract.`createTime` < '2016-07-01' 
  AND loan_renter_repay.`paydate` < '2016-07-01' 
  AND oder_signedorder.`createTime` < '2016-07-01' 
  AND DATE_FORMAT(
    loan_renter_repay.`paydate`,
    '%Y-%m-%d'
  ) > loan_renter_repayplan.`duedate` 
GROUP BY oder_signedorder.`renterId` 