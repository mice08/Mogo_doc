SELECT 
  user_landlord_childacc_rel.`userId` '子账号id',
  user_landlord_childacc_rel.`landlordId` '房东id',
  user_landlord_childacc_rel.`createTime` '子账号注册日期',
  MIN(user_loginlog.`accessTime`) '子账号首次登陆日期',
  MAX(user_loginlog.`accessTime`) '最后一次登陆时间',
  CASE
    user_landlord_childacc_rel.`status` 
    WHEN 1 
    THEN '是' 
    WHEN 0 
    THEN '无效' 
  END '是否有效',
  CASE
    WHEN user_special.id IS NOT NULL 
    THEN '是' 
  END '是否是测试数据' 
FROM
  user_landlord_childacc_rel 
  LEFT JOIN user_loginlog 
    ON user_loginlog.`userId` = user_landlord_childacc_rel.`userId` 
  LEFT JOIN user_special 
    ON user_special.`userId` = user_landlord_childacc_rel.`landlordId` 
    AND user_special.`userType` = 0 
GROUP BY user_landlord_childacc_rel.`userId` 